import{j as e,a7 as v,r as i}from"./index-DYlhEq0c.js";import{C as P}from"./CourseApiService-BRI8cBLn.js";const M=({course:a,showProgress:m=!1,progress:x=0})=>{const f=(t,l)=>parseFloat(t)===0?"Free":`${l} ${new Intl.NumberFormat().format(parseFloat(t))}`,h=t=>t<1?`${Math.round(t*60)} mins`:`${t} ${t===1?"hour":"hours"}`,g=t=>{switch(t==null?void 0:t.toLowerCase()){case"beginner":return"success";case"intermediate":return"warning";case"advanced":return"danger";default:return"primary"}},b=(t,l)=>{const c=[],o=Math.floor(t),N=t%1!==0;for(let r=0;r<5;r++)r<o?c.push(e.jsx("i",{className:"bi bi-star-fill text-warning"},r)):r===o&&N?c.push(e.jsx("i",{className:"bi bi-star-half text-warning"},r)):c.push(e.jsx("i",{className:"bi bi-star text-muted"},r));return e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"me-1",children:c}),e.jsxs("small",{className:"text-muted",children:[t.toFixed(1)," (",l," ",l===1?"review":"reviews",")"]})]})};return e.jsxs("div",{className:"card h-100 shadow-sm course-card",children:[e.jsxs("div",{className:"position-relative",children:[e.jsx("img",{src:a.cover_image?`http://127.0.0.1:8000/${a.cover_image}`:"/media/stock/600x400/img-1.jpg",alt:a.title,className:"card-img-top",style:{height:"200px",objectFit:"cover"},onError:t=>{const l=t.target;l.src="/media/stock/600x400/img-1.jpg"}}),a.is_featured&&e.jsx("div",{className:"position-absolute top-0 start-0 m-2",children:e.jsx("span",{className:"badge bg-warning",children:"Featured"})}),e.jsx("div",{className:"position-absolute top-0 end-0 m-2",children:e.jsx("span",{className:"badge",style:{backgroundColor:"#114786",color:"white"},children:f(a.price,a.currency)})}),m&&e.jsx("div",{className:"position-absolute bottom-0 start-0 end-0 p-2",children:e.jsx("div",{className:"progress",style:{height:"4px"},children:e.jsx("div",{className:"progress-bar",style:{backgroundColor:"#F33D02",width:`${x}%`},role:"progressbar","aria-valuenow":x,"aria-valuemin":0,"aria-valuemax":100})})})]}),e.jsxs("div",{className:"card-body d-flex flex-column",children:[a.category&&e.jsx("div",{className:"mb-2",children:e.jsxs("span",{className:"badge bg-light text-dark",children:[e.jsx("i",{className:`${a.category.icon||"bi bi-book"} me-1`}),a.category.name]})}),e.jsx("h6",{className:"card-title mb-2 fw-bold",style:{color:"#114786"},children:e.jsx(v,{to:`/learning/courses/${a.id}`,className:"text-decoration-none",style:{color:"inherit"},children:a.title})}),e.jsx("p",{className:"card-text text-muted small mb-3",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:a.description}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsxs("small",{className:"text-muted d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-clock me-1"}),h(a.duration_hours)]}),e.jsx("span",{className:`badge bg-${g(a.difficulty_level)}`,children:a.difficulty_level||"Intermediate"})]}),e.jsxs("div",{className:"d-flex align-items-center mb-2",children:[e.jsx("div",{className:"me-2",children:e.jsx("img",{src:a.instructor_avatar?`http://127.0.0.1:8000/${a.instructor_avatar}`:"/media/avatars/300-1.jpg",alt:a.instructor_name,className:"rounded-circle",style:{width:"24px",height:"24px",objectFit:"cover"},onError:t=>{const l=t.target;l.src="/media/avatars/300-1.jpg"}})}),e.jsx("small",{className:"text-muted",children:a.instructor_name})]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-2",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"bi bi-globe me-1"}),a.language]}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"bi bi-people me-1"}),a.enrollment_count," enrolled"]})]})]}),e.jsx("div",{className:"mb-3",children:b(a.rating,a.rating_count)}),m&&e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-1",children:[e.jsx("small",{className:"text-muted",children:"Progress"}),e.jsxs("small",{className:"fw-bold",children:[x,"%"]})]})}),e.jsx("div",{className:"mt-auto",children:e.jsx(v,{to:`/learning/courses/${a.id}`,className:"btn w-100",style:{backgroundColor:"#114786",borderColor:"#114786",color:"white"},children:m?"Continue Learning":"View Course"})})]})]})},U=()=>{const[a,m]=i.useState([]),[x,f]=i.useState([]),[h,g]=i.useState(!0),[b,t]=i.useState(null),[l,c]=i.useState(null),[o,N]=i.useState(""),[r,w]=i.useState(""),[p,k]=i.useState(""),[n,u]=i.useState(1),[y,$]=i.useState(1),[C,F]=i.useState(0);i.useEffect(()=>{S(),D()},[n,l,o,r,p]);const S=async()=>{try{g(!0);const s={page:n,per_page:12,...l&&{category_id:l},...o&&{difficulty_level:o},...r&&{search:r},...p&&{price_range:p}},j=await P.getCourses(s);m(j.data),$(j.last_page),F(j.total),t(null)}catch(s){t("Failed to load courses. Please try again."),console.error("Error loading courses:",s)}finally{g(!1)}},D=async()=>{try{const s=await P.getCourseCategories();f(s)}catch(s){console.error("Error loading categories:",s)}},E=s=>{s.preventDefault(),u(1),S()},_=()=>{c(null),N(""),w(""),k(""),u(1)},L=()=>{const s=[],j=Math.max(1,n-2),A=Math.min(y,n+2);n>1&&s.push(e.jsx("li",{className:"page-item",children:e.jsx("button",{className:"page-link",onClick:()=>u(n-1),children:"Previous"})},"prev"));for(let d=j;d<=A;d++)s.push(e.jsx("li",{className:`page-item ${d===n?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>u(d),children:d})},d));return n<y&&s.push(e.jsx("li",{className:"page-item",children:e.jsx("button",{className:"page-link",onClick:()=>u(n+1),children:"Next"})},"next")),s};return h&&a.length===0?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner-border",style:{color:"#114786"},role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2 text-muted",children:"Loading courses..."})]})}):e.jsxs("div",{className:"container-fluid px-4",children:[e.jsxs("div",{className:"d-flex flex-wrap justify-content-between align-items-center py-3 mb-4 border-bottom",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"h3 mb-0",style:{color:"#114786"},children:[e.jsx("i",{className:"bi bi-mortarboard me-2"}),"Eight Learning Courses"]}),e.jsxs("p",{className:"text-muted mb-0",children:["Discover ",C," professional courses to advance your career"]})]}),e.jsxs("div",{children:[e.jsxs(v,{to:"/learning/dashboard",className:"btn btn-outline-primary me-2",children:[e.jsx("i",{className:"bi bi-speedometer2 me-1"}),"My Dashboard"]}),e.jsxs(v,{to:"/learning/my-courses",className:"btn",style:{backgroundColor:"#114786",borderColor:"#114786",color:"white"},children:[e.jsx("i",{className:"bi bi-book me-1"}),"My Courses"]})]})]}),e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body",children:e.jsx("form",{onSubmit:E,children:e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-md-4",children:[e.jsx("label",{className:"form-label",children:"Search Courses"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",className:"form-control",placeholder:"Enter course title or keywords...",value:r,onChange:s=>w(s.target.value)}),e.jsx("button",{className:"btn btn-outline-secondary",type:"submit",children:e.jsx("i",{className:"bi bi-search"})})]})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsxs("select",{className:"form-select",value:l||"",onChange:s=>c(s.target.value?parseInt(s.target.value):null),children:[e.jsx("option",{value:"",children:"All Categories"}),x.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.course_count,")"]},s.id))]})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"Difficulty"}),e.jsxs("select",{className:"form-select",value:o,onChange:s=>N(s.target.value),children:[e.jsx("option",{value:"",children:"All Levels"}),e.jsx("option",{value:"beginner",children:"Beginner"}),e.jsx("option",{value:"intermediate",children:"Intermediate"}),e.jsx("option",{value:"advanced",children:"Advanced"})]})]}),e.jsxs("div",{className:"col-md-2",children:[e.jsx("label",{className:"form-label",children:"Price Range"}),e.jsxs("select",{className:"form-select",value:p,onChange:s=>k(s.target.value),children:[e.jsx("option",{value:"",children:"All Prices"}),e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"0-100000",children:"Under 100,000 UGX"}),e.jsx("option",{value:"100000-500000",children:"100,000 - 500,000 UGX"}),e.jsx("option",{value:"500000+",children:"Above 500,000 UGX"})]})]}),e.jsx("div",{className:"col-md-2",children:e.jsxs("button",{type:"button",className:"btn btn-outline-secondary w-100",onClick:_,children:[e.jsx("i",{className:"bi bi-x-circle me-1"}),"Clear"]})})]})})})})})}),b&&e.jsxs("div",{className:"alert alert-danger",role:"alert",children:[e.jsx("i",{className:"bi bi-exclamation-triangle me-2"}),b]}),e.jsx("div",{className:"row g-4 mb-4",children:a.length>0?a.map(s=>e.jsx("div",{className:"col-xl-3 col-lg-4 col-md-6",children:e.jsx(M,{course:s})},s.id)):!h&&e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"text-center py-5",children:[e.jsx("i",{className:"bi bi-search display-1 text-muted mb-3"}),e.jsx("h4",{className:"text-muted",children:"No courses found"}),e.jsx("p",{className:"text-muted",children:"Try adjusting your search criteria or browse all courses"}),e.jsx("button",{className:"btn btn-primary",onClick:_,children:"View All Courses"})]})})}),h&&a.length>0&&e.jsxs("div",{className:"text-center py-3",children:[e.jsx("div",{className:"spinner-border spinner-border-sm me-2",style:{color:"#114786"}}),"Loading more courses..."]}),y>1&&e.jsx("div",{className:"d-flex justify-content-center mt-4",children:e.jsx("nav",{"aria-label":"Courses pagination",children:e.jsx("ul",{className:"pagination",children:L()})})}),a.length>0&&e.jsxs("div",{className:"text-center text-muted mt-3 mb-4",children:["Showing ",(n-1)*12+1,"-",Math.min(n*12,C)," of ",C," courses"]})]})};export{U as default};
