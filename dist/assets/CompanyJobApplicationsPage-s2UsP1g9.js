import{r as a,u as Q,at as X,au as Z,j as e,c as ee,R as H,aq as se,an as N,w as f,L as D,ah as ne,ad as te,ae,C as re,ao as s,ar as P,ap as ie,as as le,aj as V,ak as B,al as oe,am as M,a0 as ce,M as p,av as c,N as de}from"./index-C-18IsR7.js";import{M as he}from"./MyJonApplicationModel-DtqyaloG.js";const u=a.forwardRef(({bsPrefix:r,className:n,as:l="div",...j},t)=>{const d=Q(r,"row"),x=X(),y=Z(),h=`${d}-cols`,g=[];return x.forEach(i=>{const b=j[i];delete j[i];let m;b!=null&&typeof b=="object"?{cols:m}=b:m=b;const v=i!==y?`-${i}`:"";m!=null&&g.push(`${h}${v}-${m}`)}),e.jsx(l,{ref:t,...j,className:ee(n,d,...g)})});u.displayName="Row";const xe={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,y:10}},F=H.memo(({status:r})=>{let n="bg-light-secondary text-secondary",l="text-secondary";switch(r){case"Pending":n="bg-light-warning text-warning",l="text-warning";break;case"Interview":n="bg-light-info text-info",l="text-info";break;case"Hired":n="bg-light-success text-success",l="text-success";break;case"Declined":n="bg-light-danger text-danger",l="text-danger";break;case"On Hold":n="bg-light-primary text-primary",l="text-primary";break;case"Rejected":n="bg-light-danger text-danger",l="text-danger";break}return e.jsx(se,{className:`badge ${n} ${l}`,children:r})});F.displayName="StatusBadge";const E=H.memo(({app:r,idx:n,currentPage:l,onOpenReviewModal:j,onOpenViewModal:t,isRowLoading:d})=>{var x;return e.jsxs("tr",{children:[e.jsx("td",{children:d?e.jsx(N,{}):(l-1)*10+(n+1)}),e.jsx("td",{children:d?e.jsx(N,{width:150}):e.jsx("a",{href:`/cv-bank/${r.employer_id}`,target:"_blank",rel:"noopener noreferrer",title:"Click to view applicant cv",children:r.employer_text||r.employer_id})}),e.jsx("td",{children:d?e.jsx(N,{width:150}):r.job_text||r.job_id}),e.jsx("td",{children:d?e.jsx(N,{width:80}):e.jsx(F,{status:r.status})}),e.jsx("td",{children:d?e.jsx(N,{width:100}):((x=r.created_at)==null?void 0:x.split("T")[0])||"N/A"}),e.jsx("td",{children:d?e.jsx(N,{width:120}):r.interview_scheduled_at?r.interview_scheduled_at.split("T")[0]:"N/A"}),e.jsxs("td",{className:"d-flex gap-1",children:[" ",d?e.jsx(N,{width:60}):e.jsx(f,{variant:"outline-primary",size:"sm",className:"btn-sm font-weight-bold",onClick:()=>t(r),children:"View Details"}),d?e.jsx(N,{width:60}):e.jsx(f,{variant:"primary",size:"sm",className:"btn-sm btn-primary font-weight-bold",onClick:()=>j(r),children:"Review"})]})]},r.id)});E.displayName="JobApplicationRow";const me=({showModal:r,selectedApp:n,onCloseModal:l})=>{var j;return n?e.jsxs(p,{show:r,onHide:l,size:"lg",centered:!0,children:[e.jsx(p.Header,{closeButton:!0,children:e.jsxs(p.Title,{children:["Application Details: ",n.job_text||n.job_id]})}),e.jsxs(p.Body,{children:[e.jsxs("section",{className:"mb-4",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-3",children:"Application Overview"}),e.jsxs(u,{children:[e.jsxs(c,{md:6,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx(F,{status:n.status})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Applied On:"})," ",((j=n.created_at)==null?void 0:j.split("T")[0])||"N/A"]}),e.jsx("p",{children:e.jsx("strong",{children:"Applicant Message:"})}),e.jsx("div",{className:"card card-body bg-light-secondary rounded-sm",children:n.applicant_message||"No message"}),e.jsxs("p",{className:"mt-2",children:[e.jsx("strong",{children:"Attachments:"})," ",n.attachments||"None"]})]}),e.jsxs(c,{md:6,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Employer Message:"})," ",n.employer_message||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Decline Reason:"})," ",n.decline_reason||"N/A"]})]})]})]}),e.jsxs("section",{className:"mb-4",style:{borderTop:"1px solid #eee",paddingTop:"15px"},children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-3",children:"Interview Details"}),e.jsxs(u,{children:[e.jsxs(c,{md:6,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Scheduled At:"})," ",n.interview_scheduled_at?n.interview_scheduled_at.split("T")[0]:"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",n.interview_location||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Type:"})," ",n.interview_type||"N/A"]})]}),e.jsxs(c,{md:6,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Result:"})," ",n.interview_result||"Pending"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Interviewer Notes:"})," ",n.interviewer_notes||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Interviewer Rating:"})," ",n.interviewer_rating||"N/A"]})]})]})]}),e.jsxs("section",{className:"mb-4",style:{borderTop:"1px solid #eee",paddingTop:"15px"},children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-3",children:"Interviewee Feedback"}),e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs("p",{children:[e.jsx("strong",{children:"Feedback to Interviewee:"})," ",n.interviewee_feedback||"N/A"]})}),e.jsx(c,{md:6,children:e.jsxs("p",{children:[e.jsx("strong",{children:"Interviewee Rating:"})," ",n.interviewee_rating||"N/A"]})})]})]}),e.jsxs("section",{className:"mb-4",style:{borderTop:"1px solid #eee",paddingTop:"15px"},children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-3",children:"Onboarding"}),e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs("p",{children:[e.jsx("strong",{children:"Contract URL:"})," ",n.contract_url||"N/A"]})}),e.jsxs(c,{md:6,children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Onboarding Start:"})," ",n.onboarding_start_date||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Onboarding Notes:"})," ",n.onboarding_notes||"N/A"]})]})]})]})]}),e.jsx(p.Footer,{children:e.jsx(f,{variant:"secondary",onClick:l,children:"Close"})})]}):null},je=({showModal:r,selectedApp:n,onCloseModal:l,onApplicationUpdate:j})=>{const[t,d]=a.useState(n),[x,y]=a.useState(!1),[h,g]=a.useState(null);a.useEffect(()=>{d(n)},[n]);const i=w=>{w.target},b=w=>{i(w)},m=async()=>{if(t){y(!0),g(null);try{var w=await de(`/job-application-update/${t.id}`,t);console.log("=============================="),console.log(w),console.log("=============================="),D.success("Application updated successfully!"),l(),j()}catch(S){console.error("Error updating application:",S),g("Failed to update application. because "+S),D.error("Failed to update application because "+S)}finally{y(!1)}}};if(!t)return null;const v=t.status,k=["Declined","Rejected"].includes(v),A=["Interview","Hired","Declined","Rejected","On Hold"].includes(v),R=["Hired","Declined","Rejected"].includes(v),I=v==="Hired";return e.jsxs(p,{show:r,onHide:l,size:"lg",centered:!0,children:[e.jsx(p.Header,{closeButton:!0,className:"bg-primary text-white",children:e.jsxs(p.Title,{className:"text-white",children:["Review Application: ",t.job_text||t.job_id]})}),e.jsxs(p.Body,{className:"p-4",children:[h&&e.jsx(B,{variant:"danger",children:h}),e.jsxs(s,{children:[e.jsxs("section",{className:"mb-6",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-4",children:"Application Status"}),e.jsxs(u,{className:"mb-3 align-items-stretch",children:[e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Current Status"})}),e.jsxs(s.Select,{name:"status",value:t.status,onChange:b,className:"form-control form-control-outline",children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Interview",children:"Interview"}),e.jsx("option",{value:"Hired",children:"Hired"}),e.jsx("option",{value:"Declined",children:"Declined"}),e.jsx("option",{value:"On Hold",children:"On Hold"}),e.jsx("option",{value:"Rejected",children:"Rejected"})]})]})}),k&&e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Decline/Reject Reason"})}),e.jsx(s.Control,{as:"textarea",rows:3,name:"decline_reason",value:t.decline_reason||"",onChange:i,placeholder:"Reason for decline/rejection (internal use)",className:"form-control form-control-outline"})]})})]})]}),e.jsxs("section",{className:"mb-6",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-4",children:"Applicant Information"}),e.jsxs(u,{className:"mb-3",children:[e.jsxs(c,{md:6,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{className:"text-dark",children:"Applicant Message:"}),e.jsx("p",{className:"text-muted card card-body bg-light-secondary rounded-sm",children:t.applicant_message||"No message"})]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-dark",children:"Attachments:"}),e.jsx("p",{className:"text-muted",children:t.attachments||"None"})]})]}),e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Employer Message to Applicant"})}),e.jsx(s.Control,{as:"textarea",rows:3,name:"employer_message",value:t.employer_message||"",onChange:i,placeholder:"Optional message to applicant",className:"form-control form-control-outline"})]})})]})]}),A&&e.jsxs("section",{className:"mb-6",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-4",children:"Interview Details"}),e.jsxs(u,{children:[e.jsxs(c,{md:6,children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Scheduled At"})}),e.jsx(s.Control,{type:"datetime-local",name:"interview_scheduled_at",value:t.interview_scheduled_at?t.interview_scheduled_at.slice(0,16):"",onChange:i,className:"form-control form-control-outline"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Location"})}),e.jsx(s.Control,{type:"text",name:"interview_location",value:t.interview_location||"",onChange:i,placeholder:"Interview Location",className:"form-control form-control-outline"})]})]}),e.jsxs(c,{md:6,children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Interview Type"})}),e.jsxs(s.Select,{name:"interview_type",value:t.interview_type||"",onChange:i,className:"form-control form-control-outline",children:[e.jsx("option",{value:"",children:"Select Type"}),e.jsx("option",{value:"In-person",children:"In-person"}),e.jsx("option",{value:"Virtual",children:"Virtual"}),e.jsx("option",{value:"Phone",children:"Phone"})]})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Interviewer Notes"})}),e.jsx(s.Control,{as:"textarea",rows:3,name:"interviewer_notes",value:t.interviewer_notes||"",onChange:i,placeholder:"Notes from the interviewer",className:"form-control form-control-outline"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Interview Result"})}),e.jsx(s.Control,{type:"text",name:"interview_result",value:t.interview_result||"",onChange:i,placeholder:"Interview Result",className:"form-control form-control-outline"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Interviewer Rating"})}),e.jsx(s.Control,{type:"text",name:"interviewer_rating",value:t.interviewer_rating||"",onChange:i,placeholder:"Rating given by interviewer",className:"form-control form-control-outline"})]})]})]})]}),R&&e.jsxs("section",{className:"mb-6",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-4",children:"Interviewee Feedback"}),e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Feedback to Interviewee"})}),e.jsx(s.Control,{as:"textarea",rows:3,name:"interviewee_feedback",value:t.interviewee_feedback||"",onChange:i,placeholder:"Feedback for the interviewee",className:"form-control form-control-outline"})]})}),e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Interviewee Rating"})}),e.jsx(s.Control,{type:"text",name:"interviewee_rating",value:t.interviewee_rating||"",onChange:i,placeholder:"Rating given by interviewee (if collected)",className:"form-control form-control-outline"})]})})]})]}),I&&e.jsxs("section",{className:"mb-6",children:[e.jsx("h5",{className:"font-weight-bold text-primary mb-4",children:"Onboarding"}),e.jsxs(u,{children:[e.jsx(c,{md:6,children:e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Contract URL"})}),e.jsx(s.Control,{type:"text",name:"contract_url",value:t.contract_url||"",onChange:i,placeholder:"URL of the contract document",className:"form-control form-control-outline"})]})}),e.jsxs(c,{md:6,children:[e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Onboarding Start Date"})}),e.jsx(s.Control,{type:"date",name:"onboarding_start_date",value:t.onboarding_start_date||"",onChange:i,className:"form-control form-control-outline"})]}),e.jsxs(s.Group,{className:"mb-3",children:[e.jsx(s.Label,{children:e.jsx("strong",{children:"Onboarding Notes"})}),e.jsx(s.Control,{as:"textarea",rows:2,name:"onboarding_notes",value:t.onboarding_notes||"",onChange:i,placeholder:"Any onboarding notes",className:"form-control form-control-outline"})]})]})]})]})]})]}),e.jsxs(p.Footer,{className:"border-top pt-4",children:[e.jsx(f,{variant:"primary",onClick:m,disabled:x,className:"btn-primary font-weight-bold",children:x?e.jsx(V,{size:"sm",animation:"border"}):"Update Application"}),e.jsx(f,{variant:"secondary",onClick:l,disabled:x,className:"btn-secondary font-weight-bold ml-2",children:"Close"})]})]})},be=()=>{const[r,n]=a.useState([]),[l,j]=a.useState(!1),[t,d]=a.useState(!1),[x,y]=a.useState(""),[h,g]=a.useState(1),[i,b]=a.useState(1),[m,v]=a.useState(""),[k,A]=a.useState(!1),[R,I]=a.useState(!1),[w,S]=a.useState(null),[G,J]=a.useState(null),[U,pe]=a.useState([]),C=a.useCallback(async(o,_)=>{j(!0),y("");try{const L={};_&&(L.search=_);const O=await he.fetchCompanyJobs(o,L);n(O.data),g(O.current_page),b(O.last_page)}catch(L){console.error(L),y("Failed to load job applications."),D.error("Error loading applications.")}finally{j(!1)}},[]);a.useEffect(()=>{C(h,m)},[h,m,C]);const $=a.useCallback(o=>{o.preventDefault(),g(1),C(1,m)},[m,C]),T=a.useCallback(o=>{o>=1&&o<=i&&g(o)},[i]),z=a.useCallback(o=>{S(o),A(!0)},[]),q=a.useCallback(()=>{A(!1)},[]),W=a.useCallback(o=>{J(o),I(!0)},[]),Y=a.useCallback(()=>{I(!1)},[]),K=a.useCallback(()=>{d(!0),C(h,m).finally(()=>d(!1))},[h,m,C]);return e.jsxs(e.Fragment,{children:[e.jsx(ne,{breadcrumbs:[{title:"Jobs",path:"/admin/company-job-applications",isActive:!1}],children:"Company - Job Applications"}),e.jsx(te,{}),e.jsx(ae,{children:e.jsx(re.div,{className:"container-fluid py-4 card shadow-sm",variants:xe,initial:"hidden",animate:"visible",exit:"exit",children:e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-md-4",children:e.jsx(s,{onSubmit:$,children:e.jsxs(P,{size:"sm",children:[e.jsx(P.Text,{className:"bg-primary border-primary text-white",children:e.jsx(ie,{color:"white"})}),e.jsx(le,{type:"text",placeholder:"Search...",value:m,onChange:o=>v(o.target.value)}),e.jsx(f,{variant:"primary",type:"submit",size:"sm"}),e.jsx(f,{variant:"primary",type:"submit",className:"btn-primary font-weight-bold",children:"Search"})]})})})}),(l||t)&&e.jsx("div",{className:"text-center py-5",children:e.jsx(V,{animation:"border",variant:"primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})})}),!l&&x&&e.jsx(B,{variant:"danger",role:"alert",children:x}),!l&&!x&&r.length===0&&e.jsx("div",{className:"d-flex flex-column align-items-center justify-content-center py-5",children:e.jsxs(B,{variant:"info",className:"text-center w-50",children:[e.jsx("h4",{className:"font-weight-bold",children:"No Job Applications Found"}),e.jsx("p",{className:"mb-4",children:"You haven't applied for any jobs yet."}),e.jsx(f,{href:"/jobs",as:"a",variant:"primary",className:"btn-primary font-weight-bold",children:"Browse Jobs"})]})}),!l&&!x&&r.length>0&&e.jsx("div",{className:"table-responsive",children:e.jsxs(oe,{striped:!0,hover:!0,className:"align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Applicant"}),e.jsx("th",{children:"Job"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Applied On"}),e.jsx("th",{children:"Interview Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r.map((o,_)=>e.jsx(E,{app:o,idx:_,currentPage:h,onOpenReviewModal:z,onOpenViewModal:W,isRowLoading:U.includes(_)},o.id))})]})}),!l&&!x&&i>1&&e.jsxs(M,{className:"mt-4 justify-content-center",children:[e.jsx(M.Prev,{onClick:()=>T(h-1),disabled:h<=1,className:"pagination-prev next-link",children:"Previous"}),Array.from({length:i},(o,_)=>_+1).map(o=>e.jsx(M.Item,{active:o===h,onClick:()=>T(o),className:"page-item",children:o},o)),e.jsx(M.Next,{onClick:()=>T(h+1),disabled:h>=i,className:"pagination-next next-link",children:"Next"})]}),e.jsxs(ce,{children:[k&&w&&e.jsx(je,{showModal:k,selectedApp:w,onCloseModal:q,onApplicationUpdate:K}),R&&G&&e.jsx(me,{showModal:R,selectedApp:G,onCloseModal:Y})]})]})})})]})};export{be as default};
