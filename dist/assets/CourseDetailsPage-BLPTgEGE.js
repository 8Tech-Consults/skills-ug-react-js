import{ba as E,x as I,r as t,j as s,z as N}from"./index-DYlhEq0c.js";import{C as n}from"./CourseApiService-BRI8cBLn.js";const D=()=>{const{courseId:c}=E(),d=I(),[e,g]=t.useState(null),[p,o]=t.useState(!0),[m,x]=t.useState(!1),[v,h]=t.useState(!1),[u,b]=t.useState(null);t.useEffect(()=>{c&&(y(),f())},[c]);const y=async()=>{try{o(!0);const a=await n.getCourse(parseInt(c));g(a),b(null)}catch(a){b("Failed to load course details. Please try again."),console.error("Error loading course:",a)}finally{o(!1)}},f=async()=>{try{const r=(await n.getMyCourseSubscriptions()).find(l=>l.course_id===parseInt(c));h(!!r)}catch(a){console.error("Error checking subscription status:",a)}},w=async()=>{if(c)try{x(!0),await n.subscribeToCourse(parseInt(c)),h(!0),N.success("Successfully enrolled in course!")}catch(a){N.error(a.message||"Failed to enroll in course"),console.error("Error subscribing to course:",a)}finally{x(!1)}},_=()=>{d(`/learning/courses/${c}/learn`)},C=(a,r)=>parseFloat(a)===0?"Free":`${r} ${new Intl.NumberFormat().format(parseFloat(a))}`,S=a=>a<1?`${Math.round(a*60)} minutes`:`${a} ${a===1?"hour":"hours"}`,k=(a,r)=>{const l=[],j=Math.floor(a),F=a%1!==0;for(let i=0;i<5;i++)i<j?l.push(s.jsx("i",{className:"bi bi-star-fill text-warning"},i)):i===j&&F?l.push(s.jsx("i",{className:"bi bi-star-half text-warning"},i)):l.push(s.jsx("i",{className:"bi bi-star text-muted"},i));return s.jsxs("div",{className:"d-flex align-items-center",children:[s.jsx("div",{className:"me-2",children:l}),s.jsxs("span",{className:"text-muted",children:[a.toFixed(1)," (",r," ",r===1?"review":"reviews",")"]})]})};return p?s.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"400px"},children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"spinner-border",style:{color:"#114786"},role:"status",children:s.jsx("span",{className:"visually-hidden",children:"Loading..."})}),s.jsx("p",{className:"mt-2 text-muted",children:"Loading course details..."})]})}):u||!e?s.jsx("div",{className:"container-fluid px-4",children:s.jsxs("div",{className:"text-center py-5",children:[s.jsx("i",{className:"bi bi-exclamation-triangle display-1 text-danger mb-3"}),s.jsx("h4",{className:"text-danger",children:"Course Not Found"}),s.jsx("p",{className:"text-muted",children:u||"The course you are looking for does not exist."}),s.jsx("button",{className:"btn btn-primary",onClick:()=>d("/learning/courses"),children:"Browse All Courses"})]})}):s.jsxs("div",{className:"container-fluid px-4",children:[s.jsx("nav",{"aria-label":"breadcrumb",className:"mb-4",children:s.jsxs("ol",{className:"breadcrumb",children:[s.jsx("li",{className:"breadcrumb-item",children:s.jsx("a",{href:"/learning/courses",className:"text-decoration-none",children:"Courses"})}),s.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:e.title})]})}),s.jsxs("div",{className:"row",children:[s.jsxs("div",{className:"col-lg-8",children:[s.jsxs("div",{className:"card shadow-sm mb-4",children:[s.jsxs("div",{className:"position-relative",children:[s.jsx("img",{src:e.cover_image?`http://127.0.0.1:8000/${e.cover_image}`:"/media/stock/900x400/img-1.jpg",alt:e.title,className:"card-img-top",style:{height:"300px",objectFit:"cover"},onError:a=>{const r=a.target;r.src="/media/stock/900x400/img-1.jpg"}}),e.preview_video&&s.jsx("div",{className:"position-absolute top-50 start-50 translate-middle",children:s.jsx("button",{className:"btn btn-light btn-lg rounded-circle",style:{width:"80px",height:"80px"},onClick:()=>window.open(e.preview_video,"_blank"),children:s.jsx("i",{className:"bi bi-play-fill",style:{fontSize:"2rem",color:"#114786"}})})}),s.jsxs("div",{className:"position-absolute top-0 start-0 m-3",children:[e.category&&s.jsx("span",{className:"badge bg-primary me-2",children:e.category.name}),e.is_featured&&s.jsx("span",{className:"badge bg-warning",children:"Featured"})]})]}),s.jsxs("div",{className:"card-body",children:[s.jsx("h1",{className:"h3 mb-3",style:{color:"#114786"},children:e.title}),s.jsx("p",{className:"text-muted mb-3",children:e.description}),s.jsxs("div",{className:"row g-3 mb-4",children:[s.jsx("div",{className:"col-md-6",children:k(e.rating,e.rating_count)}),s.jsx("div",{className:"col-md-6 text-md-end",children:s.jsxs("span",{className:"text-muted",children:[s.jsx("i",{className:"bi bi-people me-1"}),e.enrollment_count," students enrolled"]})})]}),s.jsxs("div",{className:"row g-3 text-center",children:[s.jsx("div",{className:"col-6 col-md-3",children:s.jsxs("div",{className:"border-end",children:[s.jsx("i",{className:"bi bi-clock display-6 text-primary mb-2"}),s.jsx("h6",{className:"mb-0",children:S(e.duration_hours)}),s.jsx("small",{className:"text-muted",children:"Duration"})]})}),s.jsx("div",{className:"col-6 col-md-3",children:s.jsxs("div",{className:"border-end",children:[s.jsx("i",{className:"bi bi-bar-chart display-6 text-success mb-2"}),s.jsx("h6",{className:"mb-0 text-capitalize",children:e.difficulty_level}),s.jsx("small",{className:"text-muted",children:"Level"})]})}),s.jsx("div",{className:"col-6 col-md-3",children:s.jsxs("div",{className:"border-end",children:[s.jsx("i",{className:"bi bi-globe display-6 text-info mb-2"}),s.jsx("h6",{className:"mb-0",children:e.language}),s.jsx("small",{className:"text-muted",children:"Language"})]})}),s.jsxs("div",{className:"col-6 col-md-3",children:[s.jsx("i",{className:"bi bi-trophy display-6 text-warning mb-2"}),s.jsx("h6",{className:"mb-0",children:"Certificate"}),s.jsx("small",{className:"text-muted",children:"Included"})]})]})]})]}),s.jsxs("div",{className:"card shadow-sm mb-4",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx("i",{className:"bi bi-info-circle me-2"}),"About This Course"]})}),s.jsx("div",{className:"card-body",children:s.jsx("div",{className:"course-content",dangerouslySetInnerHTML:{__html:e.detailed_description}})})]}),e.learning_outcomes&&e.learning_outcomes.length>0&&s.jsxs("div",{className:"card shadow-sm mb-4",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx("i",{className:"bi bi-check-circle me-2"}),"What You'll Learn"]})}),s.jsx("div",{className:"card-body",children:s.jsx("div",{className:"row",children:e.learning_outcomes.map((a,r)=>s.jsx("div",{className:"col-md-6 mb-2",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("i",{className:"bi bi-check-circle-fill text-success me-2 mt-1"}),s.jsx("span",{children:a})]})},r))})})]}),e.requirements&&e.requirements.length>0&&s.jsxs("div",{className:"card shadow-sm mb-4",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h5",{className:"mb-0",children:[s.jsx("i",{className:"bi bi-list-check me-2"}),"Requirements"]})}),s.jsx("div",{className:"card-body",children:s.jsx("ul",{className:"list-unstyled",children:e.requirements.map((a,r)=>s.jsxs("li",{className:"mb-2",children:[s.jsx("i",{className:"bi bi-arrow-right me-2 text-muted"}),a]},r))})})]})]}),s.jsxs("div",{className:"col-lg-4",children:[s.jsxs("div",{className:"card shadow-sm mb-4",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h6",{className:"mb-0",children:[s.jsx("i",{className:"bi bi-person-circle me-2"}),"Instructor"]})}),s.jsx("div",{className:"card-body",children:s.jsxs("div",{className:"d-flex align-items-start",children:[s.jsx("img",{src:e.instructor_avatar?`http://127.0.0.1:8000/${e.instructor_avatar}`:"/media/avatars/300-1.jpg",alt:e.instructor_name,className:"rounded-circle me-3",style:{width:"60px",height:"60px",objectFit:"cover"},onError:a=>{const r=a.target;r.src="/media/avatars/300-1.jpg"}}),s.jsxs("div",{children:[s.jsx("h6",{className:"mb-1",children:e.instructor_name}),s.jsx("p",{className:"text-muted small mb-0",children:e.instructor_bio})]})]})})]}),s.jsx("div",{className:"card shadow-sm mb-4",children:s.jsxs("div",{className:"card-body text-center",children:[s.jsx("div",{className:"mb-3",children:s.jsx("span",{className:"h3",style:{color:"#F33D02"},children:C(e.price,e.currency)})}),v?s.jsxs("div",{children:[s.jsxs("div",{className:"alert alert-success",role:"alert",children:[s.jsx("i",{className:"bi bi-check-circle me-2"}),"You are enrolled in this course"]}),s.jsxs("button",{className:"btn w-100 mb-2",style:{backgroundColor:"#114786",borderColor:"#114786",color:"white"},onClick:_,children:[s.jsx("i",{className:"bi bi-play-circle me-2"}),"Start Learning"]})]}):s.jsx("button",{className:"btn w-100 mb-2",style:{backgroundColor:"#F33D02",borderColor:"#F33D02",color:"white"},onClick:w,disabled:m,children:m?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Enrolling..."]}):s.jsxs(s.Fragment,{children:[s.jsx("i",{className:"bi bi-plus-circle me-2"}),"Enroll Now"]})}),s.jsx("small",{className:"text-muted",children:"30-day money-back guarantee"})]})}),e.tags&&e.tags.length>0&&s.jsxs("div",{className:"card shadow-sm",children:[s.jsx("div",{className:"card-header",children:s.jsxs("h6",{className:"mb-0",children:[s.jsx("i",{className:"bi bi-tags me-2"}),"Tags"]})}),s.jsx("div",{className:"card-body",children:e.tags.map((a,r)=>s.jsx("span",{className:"badge bg-light text-dark me-1 mb-1",children:a},r))})]})]})]})]})};export{D as default};
