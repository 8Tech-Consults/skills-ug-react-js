import{j as e,r as m,z as p}from"./index-DYlhEq0c.js";import{s as u}from"./ServiceApiService-Bp_o-kdC.js";const w=({service:a,onBookmarkClick:n,onViewDetails:x,className:b=""})=>{const o=(r,t="UGX")=>new Intl.NumberFormat("en-UG",{style:"currency",currency:t==="UGX"?"USD":t,minimumFractionDigits:0}).format(r).replace("$","UGX "),h=r=>{r.stopPropagation(),n==null||n(a.id)},i=()=>{x==null||x(a.id)};return e.jsxs("div",{className:`card service-card h-100 ${b}`,onClick:i,children:[e.jsxs("div",{className:"position-relative",children:[e.jsx("img",{src:a.cover_image?`http://127.0.0.1:8000/storage/${a.cover_image}`:"/media/misc/service-placeholder.jpg",className:"card-img-top service-image",alt:a.title,style:{height:"200px",objectFit:"cover",cursor:"pointer"}}),e.jsx("button",{className:"btn btn-sm btn-light position-absolute top-0 end-0 m-2 rounded-circle",onClick:h,style:{width:"35px",height:"35px"},children:e.jsx("i",{className:"bi bi-bookmark",style:{fontSize:"14px"}})}),a.promotional_badge&&e.jsx("span",{className:"badge bg-warning position-absolute top-0 start-0 m-2",children:a.promotional_badge}),a.average_rating>0&&e.jsx("div",{className:"position-absolute bottom-0 start-0 m-2",children:e.jsxs("span",{className:"badge bg-dark bg-opacity-75 text-white",children:[e.jsx("i",{className:"bi bi-star-fill text-warning me-1"}),a.average_rating.toFixed(1)," (",a.review_count,")"]})})]}),e.jsxs("div",{className:"card-body d-flex flex-column",children:[a.job_category&&e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"badge bg-primary bg-opacity-10 text-primary",children:a.job_category.name})}),e.jsx("h5",{className:"card-title mb-2 service-title",style:{fontSize:"16px",fontWeight:"600",lineHeight:"1.4",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:a.title}),e.jsx("p",{className:"card-text text-muted small mb-3",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",lineHeight:"1.4"},children:a.description}),a.provider&&e.jsxs("div",{className:"d-flex align-items-center mb-3",children:[e.jsx("div",{className:"symbol symbol-30px me-3",children:e.jsx("img",{src:a.provider.avatar?`http://127.0.0.1:8000/storage/${a.provider.avatar}`:"/media/avatars/blank.png",alt:a.provider.name,className:"rounded-circle",style:{width:"30px",height:"30px",objectFit:"cover"}})}),e.jsxs("div",{children:[e.jsx("div",{className:"fw-bold small",style:{fontSize:"13px"},children:a.provider.name}),a.location&&e.jsxs("div",{className:"text-muted",style:{fontSize:"12px"},children:[e.jsx("i",{className:"bi bi-geo-alt me-1"}),a.location]})]})]}),e.jsxs("div",{className:"mb-3",children:[a.delivery_time&&e.jsxs("div",{className:"d-flex align-items-center mb-1",children:[e.jsx("i",{className:"bi bi-clock me-2 text-muted"}),e.jsxs("span",{className:"small text-muted",children:["Delivery: ",a.delivery_time]})]}),a.experience_years&&e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-award me-2 text-muted"}),e.jsxs("span",{className:"small text-muted",children:[a.experience_years," experience"]})]})]}),e.jsx("div",{className:"mt-auto",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h6 mb-0 text-primary fw-bold",children:o(a.price,a.currency||"UGX")}),a.price_description&&e.jsx("small",{className:"text-muted",children:a.price_description})]}),e.jsx("button",{className:"btn btn-primary btn-sm",onClick:r=>{r.stopPropagation(),i()},children:"View Details"})]})}),a.tags&&e.jsx("div",{className:"mt-3",children:a.tags.split(",").slice(0,3).map((r,t)=>e.jsx("span",{className:"badge bg-light text-dark me-1 mb-1",style:{fontSize:"10px"},children:r.trim()},t))})]})]})},C=()=>{const[a,n]=m.useState([]),[x,b]=m.useState([]),[o,h]=m.useState(!0),[i,r]=m.useState({page:1,limit:12,sort_by:"latest"}),[t,N]=m.useState({current_page:1,last_page:1,total:0}),g=async s=>{h(!0);try{const l=s||i,c=await u.getServices(l);c.success&&c.data?(n(c.data.services),N(c.data.pagination)):(p.error(c.error||"Failed to load services"),n([]))}catch{p.error("Failed to load services"),n([])}finally{h(!1)}},v=async()=>{try{const s=await u.getServiceCategories();s.success&&s.data&&b(s.data)}catch(s){console.error("Failed to load categories:",s)}};m.useEffect(()=>{g(),v()},[]);const d=s=>{const l={...i,...s,page:1};r(l),g(l)},y=s=>{d({search:s})},j=s=>{const l={...i,page:s};r(l),g(l)},f=async s=>{try{const l=await u.toggleBookmark(s);l.success?p.success("Bookmark updated successfully"):p.error(l.error||"Failed to update bookmark")}catch{p.error("Failed to update bookmark")}},_=s=>{window.location.href=`/services/${s}`};return e.jsxs("div",{className:"container-fluid py-4",children:[e.jsx("div",{className:"row mb-4",children:e.jsxs("div",{className:"col-12",children:[e.jsx("h1",{className:"h3 mb-0 text-gray-800",children:"Service Marketplace"}),e.jsx("p",{className:"text-muted",children:"Discover professional services from skilled providers"})]})}),e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label small fw-bold text-dark",children:"Search Services"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:e.jsx("i",{className:"bi bi-search"})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by title, description, or tags...",value:i.search||"",onChange:s=>y(s.target.value)})]})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label small fw-bold text-dark",children:"Category"}),e.jsxs("select",{className:"form-select",value:i.category_id||"",onChange:s=>d({category_id:s.target.value?parseInt(s.target.value):void 0}),children:[e.jsx("option",{value:"",children:"All Categories"}),x.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label small fw-bold text-dark",children:"Sort By"}),e.jsxs("select",{className:"form-select",value:i.sort_by||"latest",onChange:s=>d({sort_by:s.target.value}),children:[e.jsx("option",{value:"latest",children:"Latest"}),e.jsx("option",{value:"popular",children:"Most Popular"}),e.jsx("option",{value:"rating",children:"Highest Rated"}),e.jsx("option",{value:"price_low",children:"Price: Low to High"}),e.jsx("option",{value:"price_high",children:"Price: High to Low"})]})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label small fw-bold text-dark",children:"Price Range (UGX)"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("input",{type:"number",className:"form-control form-control-sm",placeholder:"Min",value:i.min_price||"",onChange:s=>d({min_price:s.target.value?parseInt(s.target.value):void 0})}),e.jsx("input",{type:"number",className:"form-control form-control-sm",placeholder:"Max",value:i.max_price||"",onChange:s=>d({max_price:s.target.value?parseInt(s.target.value):void 0})})]})]})})]})})})})}),e.jsx("div",{className:"row mb-3",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h6",{className:"mb-0 text-muted",children:o?"Loading...":`${t.total} services found`}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("button",{className:"btn btn-outline-primary btn-sm",onClick:()=>d({is_featured:!0}),disabled:o,children:[e.jsx("i",{className:"bi bi-star me-1"}),"Featured Only"]}),e.jsxs("button",{className:"btn btn-outline-secondary btn-sm",onClick:()=>{r({page:1,limit:12,sort_by:"latest"}),g({page:1,limit:12,sort_by:"latest"})},disabled:o,children:[e.jsx("i",{className:"bi bi-arrow-clockwise me-1"}),"Reset"]})]})]})})}),o?e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12 text-center py-5",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"text-muted mt-3",children:"Loading services..."})]})}):a.length===0?e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12 text-center py-5",children:[e.jsx("div",{className:"mb-4",children:e.jsx("i",{className:"bi bi-search display-1 text-muted"})}),e.jsx("h5",{className:"text-muted",children:"No services found"}),e.jsx("p",{className:"text-muted",children:"Try adjusting your search criteria"})]})}):e.jsx("div",{className:"row",children:a.map(s=>e.jsx("div",{className:"col-xl-3 col-lg-4 col-md-6 mb-4",children:e.jsx(w,{service:s,onBookmarkClick:f,onViewDetails:_,className:"h-100"})},s.id))}),t.last_page>1&&e.jsx("div",{className:"row mt-4",children:e.jsx("div",{className:"col-12",children:e.jsx("nav",{"aria-label":"Services pagination",children:e.jsxs("ul",{className:"pagination justify-content-center",children:[e.jsx("li",{className:`page-item ${t.current_page<=1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>j(t.current_page-1),disabled:t.current_page<=1,children:e.jsx("i",{className:"bi bi-chevron-left"})})}),Array.from({length:Math.min(5,t.last_page)},(s,l)=>{const c=l+1;return e.jsx("li",{className:`page-item ${t.current_page===c?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>j(c),children:c})},c)}),e.jsx("li",{className:`page-item ${t.current_page>=t.last_page?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>j(t.current_page+1),disabled:t.current_page>=t.last_page,children:e.jsx("i",{className:"bi bi-chevron-right"})})})]})})})})]})};export{C as default};
