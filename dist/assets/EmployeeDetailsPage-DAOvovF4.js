import{b9 as D,x as P,y as I,r as t,j as e,ao as g,H as M,U as w,a7 as o,ag as v,z as n,ba as O,C as U,bi as B}from"./index-D1_DXHNL.js";import{C as H}from"./CvModel-KlK3XX17.js";const G={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,y:10}},R=()=>{const{id:r}=D(),c=P(),{currentUser:k,jobseekerManifest:m}=I(),[a,F]=t.useState(null),[d,E]=t.useState([]),[C,p]=t.useState(!0),[S,h]=t.useState(!0),[x,J]=t.useState(""),[y,u]=t.useState(!1),[A,b]=t.useState(!1),j=async()=>{if(await B.getItems(),m&&k){for(const s of m.company_follows)if(s.company_id+""==r+""){b(!0);break}}};t.useEffect(()=>{if(!r)return;(async()=>{try{p(!0);const l=await v(`/cvs/${r}`);if(l.code!==1)throw new Error(l.message||"Failed to fetch employer details.");const i=H.fromJson(l.data);F(i),j()}catch{J("Failed to load employer details."),n.error("Failed to load employer details.")}finally{p(!1)}})()},[r]),t.useEffect(()=>{if(!r)return;(async()=>{try{h(!0);const l=await v(`/jobs?posted_by_id=${r}`);if(l.code!==1)throw new Error(l.message||"Failed to fetch employer jobs.");const i=await O.fetchJobs(1,{posted_by_id:r,per_page:50});E(i.data)}catch{n.error("Failed to load jobs for this employer.")}finally{h(!1)}})()},[r]);const L=async()=>{if(a){u(!0);try{const s={company_id:a.id};await U("/company-follow",s),await j(),b(!0),n.success("You are now following this company.")}catch(s){n.error("Failed to follow the company: "+s)}finally{u(!1)}}},N=s=>{if(!s)return null;try{return JSON.parse(s)}catch{return null}};if(C)return e.jsx("div",{className:"container py-4",children:e.jsx(g,{count:10})});if(x||!a)return e.jsxs("div",{className:"container py-4",children:[e.jsxs("div",{className:"alert alert-danger",children:["Error: ",x||"Employer not found."]}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>c(-1),children:"Go Back"})]});const f=N(a.company_operating_hours),_=N(a.company_certifications);return e.jsxs(M.div,{className:"container py-4",variants:G,initial:"hidden",animate:"visible",exit:"exit",children:[e.jsx("button",{className:"btn btn-link mb-3",onClick:()=>c(-1),children:"« Back to Employers"}),e.jsxs("div",{className:"d-flex align-items-center border-bottom pb-3 mb-3",children:[e.jsx("img",{src:w.img(a.company_logo||"default-company.png"),alt:a.company_name,className:"me-3",style:{width:"120px",height:"120px",borderRadius:"8px",objectFit:"cover"}}),e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:a.company_name}),e.jsxs("p",{className:"mb-0",children:[e.jsx("strong",{children:"Established:"})," ",a.company_year_of_establishment||"N/A"]}),e.jsxs("p",{className:"mb-0",children:[e.jsx("strong",{children:"Employees:"})," ",a.company_employees_range||"N/A"]}),e.jsxs("p",{className:"mb-0",children:[e.jsx("strong",{children:"Country:"})," ",a.company_country||"N/A"]})]}),e.jsx("div",{className:"ms-auto",children:A?e.jsxs(e.Fragment,{children:[e.jsx(o,{to:"/admin/my-company-follows",className:"btn btn-success me-2",children:"Browse Followed Companies"}),e.jsx(o,{to:"/employers",className:"btn btn-secondary",children:"Browse More Companies"})]}):e.jsx("button",{className:"btn btn-primary",disabled:y,onClick:L,children:y?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Following..."]}):"Follow Company"})})]}),e.jsxs("div",{className:"row mb-4",children:[e.jsxs("div",{className:"col-lg-6 mb-3",children:[e.jsx("h5",{className:"mb-2",children:"Company Overview"}),e.jsx("p",{children:a.company_description||"No description available."}),e.jsx("hr",{className:"my-2"})]}),e.jsxs("div",{className:"col-lg-6 mb-3",children:[e.jsx("h5",{className:"mb-2",children:"Contact & Online Presence"}),e.jsxs("dl",{className:"row mb-0",children:[e.jsx("dt",{className:"col-sm-5",children:"Address:"}),e.jsx("dd",{className:"col-sm-7",children:a.company_address||"N/A"}),e.jsx("dt",{className:"col-sm-5",children:"Website:"}),e.jsx("dd",{className:"col-sm-7",children:a.company_website_url?e.jsx("a",{href:a.company_website_url,target:"_blank",rel:"noopener noreferrer",children:a.company_website_url}):"N/A"}),e.jsx("dt",{className:"col-sm-5",children:"Facebook:"}),e.jsx("dd",{className:"col-sm-7",children:a.company_facebook_url?e.jsx("a",{href:a.company_facebook_url,target:"_blank",rel:"noopener noreferrer",children:"Facebook Page"}):"N/A"}),e.jsx("dt",{className:"col-sm-5",children:"LinkedIn:"}),e.jsx("dd",{className:"col-sm-7",children:a.company_linkedin_url?e.jsx("a",{href:a.company_linkedin_url,target:"_blank",rel:"noopener noreferrer",children:"LinkedIn Profile"}):"N/A"})]})]})]}),e.jsxs("div",{className:"row mb-4",children:[f&&e.jsxs("div",{className:"col-lg-6 mb-3",children:[e.jsx("h5",{className:"mb-2",children:"Operating Hours"}),e.jsx("ul",{className:"list-unstyled mb-0",children:Object.entries(f).map(([s,l])=>e.jsxs("li",{children:[e.jsxs("strong",{children:[s,":"]})," ",l]},s))})]}),_&&e.jsxs("div",{className:"col-lg-6 mb-3",children:[e.jsx("h5",{className:"mb-2",children:"Certifications"}),e.jsx("ul",{className:"list-unstyled mb-0",children:_.map((s,l)=>e.jsx("li",{children:s},l))})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("h5",{className:"mb-3",children:["Jobs Posted by ",a.company_name]}),S?e.jsx(g,{count:5}):d.length>0?e.jsx("div",{className:"list-group",children:d.map(s=>e.jsxs(o,{to:`/jobs/${s.id}`,className:"list-group-item list-group-item-action py-2",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h6",{className:"mb-0",children:s.title}),e.jsxs("small",{className:"text-muted",children:["Posted: ",w.formatDate(s.created_at)]})]}),e.jsx("div",{className:"mt-1",children:e.jsxs("small",{className:"text-muted",children:["Deadline: ",new Date(s.deadline).toLocaleDateString()," |"," ",s.employment_status," | ",s.workplace]})}),s.show_salary==="Yes"&&e.jsx("div",{className:"mt-1",children:e.jsxs("small",{className:"text-muted",children:["Salary: UGX"," ",new Intl.NumberFormat().format(s.minimum_salary)," – UGX"," ",new Intl.NumberFormat().format(s.maximum_salary)]})}),e.jsx("div",{className:"mt-1",children:e.jsxs("small",{className:"text-muted",children:["Location: ",s.district_text||s.address]})}),s.experience_period&&e.jsx("div",{className:"mt-1",children:e.jsxs("small",{className:"text-muted",children:["Experience: ",s.experience_period]})}),s.minimum_academic_qualification&&e.jsx("div",{className:"mt-1",children:e.jsxs("small",{className:"text-muted",children:["Qualification: ",s.minimum_academic_qualification]})})]},s.id))}):e.jsx("p",{children:"No jobs posted by this employer."})]})]})};export{R as default};
