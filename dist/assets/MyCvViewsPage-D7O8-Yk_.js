import{r as i,j as e,an as y,_ as C,L as S,ah as P,ae as R,ad as _,C as E,aj as k,ak as f,al as A,am as h}from"./index-C-18IsR7.js";import{V as F}from"./ViewRecord -BUx9Jr9n.js";const L={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3}},exit:{opacity:0,y:10}},g=i.memo(({record:t,idx:x,currentPage:n,rowLoading:c})=>{const d=(n-1)*10+(x+1);return e.jsxs("tr",{children:[e.jsx("td",{children:c?e.jsx(y,{}):d}),e.jsx("td",{children:c?e.jsx(y,{width:120}):t.viewer_text||t.viewer_id||"N/A"}),e.jsx("td",{children:c?e.jsx(y,{width:100}):t.created_at?t.created_at.split("T")[0]:"N/A"})]})});g.displayName="ViewRecordRow";const O=()=>{const[t,x]=i.useState([]),[n,c]=i.useState(!1),[d,v]=i.useState(""),[r,u]=i.useState(1),[l,b]=i.useState(1),w=i.useCallback(async s=>{c(!0),v("");try{const a={type:"CV"},N=new URLSearchParams({page:String(s),...Object.fromEntries(Object.entries(a).map(([p,V])=>[p,String(V)]))}),j=await C(`/view-records?${N.toString()}`);if(j.code!==1)throw new Error(j.message||"Failed to fetch view records.");const o=j.data;o.data=o.data.map(p=>F.fromJson(p)),x(o.data),u(o.current_page),b(o.last_page)}catch(a){console.error("Error fetching view records:",a),v(a.message||"Failed to load view records."),S.error(a.message||"Failed to load view records.")}finally{c(!1)}},[]);i.useEffect(()=>{w(r)},[w,r]);const m=s=>{s>=1&&s<=l&&u(s)};return e.jsxs(e.Fragment,{children:[e.jsx(P,{breadcrumbs:[{title:"My CV Views",path:"/my-cv-views",isActive:!0}],children:"My CV Views"}),e.jsxs(R,{children:[e.jsx(_,{}),e.jsx(E.div,{className:"container-fluid card py-4 card shadow-sm",variants:L,initial:"hidden",animate:"visible",exit:"exit",children:e.jsxs("div",{className:"card-body",children:[n&&e.jsx("div",{className:"text-center py-5",children:e.jsx(k,{animation:"border",variant:"primary"})}),!n&&d&&e.jsx(f,{variant:"danger",className:"text-center",children:d}),!n&&!d&&t.length===0&&e.jsx(f,{variant:"info",className:"text-center",children:"No CV views recorded yet."}),!n&&!d&&t.length>0&&e.jsx("div",{className:"table-responsive",children:e.jsxs(A,{striped:!0,hover:!0,className:"align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"50px"},children:"#"}),e.jsx("th",{children:"Viewer"}),e.jsx("th",{children:"Viewed On"})]})}),e.jsx("tbody",{children:t.map((s,a)=>e.jsx(g,{record:s,idx:a,currentPage:r,rowLoading:!1},s.id))})]})}),!n&&!d&&l>1&&e.jsxs(h,{className:"mt-4 justify-content-center",children:[e.jsx(h.Prev,{onClick:()=>m(r-1),disabled:r===1,children:"Previous"}),Array.from({length:l},(s,a)=>a+1).map(s=>e.jsx(h.Item,{active:s===r,onClick:()=>m(s),children:s},s)),e.jsx(h.Next,{onClick:()=>m(r+1),disabled:r===l,children:"Next"})]})]})}),e.jsx("style",{children:`
        .card {
          border-radius: 8px;
        }
        .card-header {
          font-family: Arial, sans-serif;
        }
        @media print {
          .card {
            box-shadow: none;
            border: none;
          }
        }
      `})]})]})};export{O as default};
